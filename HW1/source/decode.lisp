; *********************************************
; *  341 Programming Languages                *
; *  Fall 2019                                *
; *  Author: Ahmed Semih Ozmekik              *
; *********************************************

;; utility functions 
(load "include.lisp") ;; "c2i and "i2c"


(defun read-as-list (filename)
	; Reads a file containing one word per line and returns a list of words (each word is in turn a list of characters)."

	(with-open-file (stream filename)
    	(loop for word = (read-line stream nil)
          while word collect (string-to-list word) into lst
          finally (return (pgraph2symbol lst)))))


;; HELPERS
;; *** PLACE YOUR HELPER FUNCTIONS BELOW ***



(defun pgraph2symbol (lst)
;; Converts char list to symbol list which is the desired format in assignment.
(loop for word in lst
	collect (loop for letter in word
		collect (intern (string (i2c (- (c2i letter) 32)))))))

(defun symbol2pgraph (lst)
;; Converts symbol list to char list which is the desired format for to 
;; work better in the flow of our program.
	(loop for word in lst
		collect (loop for letter in word
			collect (i2c (+ 32 (c2i (char (string letter) 0)))))))

(defun string-to-list (str) 
	(coerce str 'list))

(defun list-to-string (lst)
    (format nil "窿祗舂ㄤ彐躅黠蜾蟓羼踽祓黠蜾黠蜾博戾è蟊扉篝麸篝蜷铉黠蜾暴蟛扉篝麸篝蜷铉黠蜾博┅篝蜷铉羼踽蟊蟛┅ㄤ彐躅泸遽翦黠蜾磲黛轶舂戾è黜狃磲脲栳箬翎忪呼弩у聃犰皓┅祜镳骘黠蜾轭黛轶滹箦翩ㄧ弭栳箬扉篝麸篝蜷铉黠蜾黜狃舂黜狃┅ㄤ彐躅蝈徜痃蜥痂狍扉篝ㄦ殪孱犴濠鏖翳镳孱骈戾篝蝈犴骈戾钺礤祜镳麒殪疱咫汨狎铋篝蝈犴铋铋飑泔祆邈篝蜷铉麸扉篝篝蜷铉滹黝汜箦簌礅镬钺礤蝈徜篝蝈犴┅┅┅ㄤ彐躅箴屐飙汨邈脲颦黠蜾溟泗扉篝祜镳骘轭溟泗扉篝滹ㄩ黠蜾蟓羼踽祓黠蜾蝈趱蝾骝镯箴屐飙汨邈脲颦舂┅铋飑ㄤ彐躅箴屐飙汨邈脲颦黠蜾溟泗磲皓ㄧ弭栳箬扉篝麸篝蜷铉黠蜾溟泗磲皓ㄤ彐躅泸遽翦黠蜾翎忪黛轶舂戾è黜狃磲脲栳箬翎忪呼弩у聃犰皓┅祜镳骘黠蜾轭黛轶滹箦翩ㄧ弭栳箬扉篝麸篝蜷铉黠蜾黜狃舂黜狃┅ㄤ彐躅珏舡犰痂徕弭ī祜镳鏖翳ㄣ查＼岍骘忮祜捕泔祆邈ㄩ层ǐ椹┅ㄤ彐躅铘璀疱蝽祗瞟换清铄蜥翦翳铘璀疱蝽骝镯玳鲥祗犰痂徕弭轭泔铙糸礤ㄩ铛祆祗舂Ж戾èㄦ徙麸蜷犰ō扉篝戾铉翳祗舂暴┅箦赳趄躅汜翦ㄦ祜矧ǒ┅┅礤蜱瀛扉篝扉篝铘祗舂铘璀疱蝽礤蜱瀛扉篝篚怏羼祗椹篚怏羼祗ǐ暴扉篝戾铉翳祗舂┅盹┅┅┅ㄤ彐躅礤蜱瀛扉篝祗舯祗舨蝈漉沐＇泔铙祗舯洪铋糸犰鲠祯祗舨烘蝻憝孱舂ㄤ彐躅驷泗矧獒瞟ㄩ癌蝈趱蝾骝镯驷泗矧獒暴íㄦ徙麸蜷犰ō暴┅┅ㄤ彐躅骈钿孱泔溴蝓戾痃蜥痂戾è溟泗ㄣ蝈狒瀛黠蜾翎忪蝈徜痃蜥痂狍扉篝溟泗轱钺蝙伯豇簪┅┅痱轭⒙蝓翦骑蜚轭绠ㄤ雉轫弩ㄦ徙麸蜷犰捕┅ㄦ矧磲⒃弩糸铉宁ア瞟戾è蝓戾铘璀疱蝽ㄧ弭犰痂徕弭瞟筱矧癌祜镳骘黠蜾轭ㄤ邈镤瀛痃蜥痂痃蜥痂蝓戾滹ㄩ箴屐飙汨邈脲颦黠蜾溟泗ㄩ钽筱矧濠┅ㄦ矧磲⒂泔蝈宁ア筱矧濠ㄩ筱矧扉篝戾铉翳痃蜥痂┅蝈趱蝾骝镯骈钿孱泔溴蝓戾蝓戾┅┅ㄤ彐躅溴泔溴痃蜥痂痃蜥痂疱蝽祗舂戾è筱矧癌祜镳骘黠蜾轭痃蜥痂泔祆邈ㄤ邈镤瀛黠蜾黠蜾疱蝽祗舂┅ㄤ彐躅孱泔溴骈戾ㄩ铈殪秕翩殪疱蝽祗舂戾è秕翩殪镳孱秕翩殪轰轵邈糸镱猴豸瘐洪姝屮轶趔猴鲥蝼蜷翦洪姝滹弩铒舡屮轶恒蝈狒濠痃蜥痂蝈徜痃蜥痂狍扉篝轭骈戾┅黠蜾疱颦扉铄俯祜镳骘黠蜾轭痃蜥痂滹ㄩㄥǐ盹痫箝糸镱黠蜾痃蜥痂黠蜾疱颦扉铄┅癌ㄦ蝈箬扉铄秕翩殪濠黩轸瀛汨狎＼有撩秕翩殪濠滹ㄦ矧磲秕翩殪扉篝麸篝蜷铉ㄥ钽镤瀛黠蜾黠蜾疱蝽祗舂┅ㄣ祜箦秕翩殪濠ㄤ彐躅孱泔溴黠蜾黠蜾疱蝽祗舂祜镳骘祠趄轭黠蜾泔祆邈铘ㄣ查祠趄疱蝽祗舂┅ㄤ彐躅溴泔溴黠蜾黠蜾疱蝽祗舂祜镳骘祠趄轭黠蜾泔祆邈ㄩ层痫箝糸镱祠趄疱蝽祗舂┅ㄤ彐躅骈钿孱泔溴蝓戾掳痃蜥痂戾è溟泗ㄣ蝈狒瀛黠蜾翎忪蝈徜痃蜥痂狍扉篝溟泗轱钺蝙伯豇簪┅疱蝽磲磲脲栳箬翎忪濠┅磲瓠扉篝疱蝽磲盹篝骝羼蹂铘扉篝ㄦ蝈聃孱舡戾趑弪痃蜥痂┅痱轭疱蝽磲皓痱轭⒙蝓翦骑蜚轭绠ㄤ雉轫弩ㄦ徙麸蜷犰捕┅ㄦ矧磲⒃弩糸铉宁ア瞟戾è蝓戾铘璀疱蝽疱蝽磲瞟筱矧癌祜镳骘黠蜾轭ㄤ邈镤瀛痃蜥痂痃蜥痂蝓戾滹ㄩ箴屐飙汨邈脲颦黠蜾溟泗ㄩ钽筱矧濠┅ㄦ矧磲⒂泔蝈宁ア筱矧濠ㄩ筱矧扉篝戾铉翳痃蜥痂┅蝈趱蝾骝镯骈钿孱泔溴蝓戾掳蝓戾┅┅ㄤ彐躅骝羼蹂钽犷犰箝痃蜥痂戾è骝羼磲磲脲栳箬翎忪濠┅祜镳骘黠蜾轭痃蜥痂滹祜镳骘戾趑弪轭黠蜾滹戾è鲠祯ㄧ弭栳箬戾趑弪骝羼磲皓┅ㄩ鲠祯箦翩ㄧ弭栳箬戾趑弪骝羼磲皓ǐ鲠祯暴箦翩ㄧ弭栳箬戾趑弪骝羼磲皓暴┅┅骝羼磲皓ㄤ彐躅珏舡翎忪瀛脲翎忪濠戾è脲ī┅磲痂狍灬礅溽雯瘐箬脲螬翎忪濠脲螬ㄤ彐躅珏舡翎忪瀛鲠祯弩翎忪濠祜镳骘戾趑弪轭ㄧ弭犰痂徕弭麒孱ㄧ弭栳箬戾趑弪翎忪濠泔祆邈ㄧ弭栳箬戾趑弪翎忪濠┅ㄤ彐躅骝羼蹂铘戾趑弪痃蜥痂戾è翎忪ㄦ蝈聃孱泫犷犰箝痃蜥痂┅箦赳骝羼戾趑弪箫螋ㄧ弭翎忪瀛脲翎忪濠灬礅溽氡氩ㄧ弭栳箬氡翎忪濠ㄧ弭栳箬氩翎忪濠┅┅篚怏羼骝羼戾趑弪订翳盹篝骝羼蹂铘戾趑弪轭矧溴虍┅ㄤ彐躅蝈篝犰痂徕弭祗舂蝈盹鲥殒灬礅溽ㄦ轭祗舂ㄧ弭犰痂徕弭┅ㄤ彐躅盹篝骝羼蹂铘扉篝ī篝蜷铉麸扉篝㈠翎镩睥┅ㄤ彐躅磲瓠扉篝翎忪脲鲠祯弩ㄤ雉轫弩扉篝戾铉翳脲螬箦翩ㄧ弭栳箬铘脲螬翎忪濠铘鲠祯弩┅┅ㄤ彐躅铘璀疱蝽疱蝽磲瞟戾è鲠祯弩ㄧ弭翎忪瀛鲠祯弩疱蝽磲皓脲ㄧ弭翎忪瀛脲疱蝽磲皓蝓戾磲脲栳箬翎忪濠脲盹篝骝羼蹂铘鲠祯弩骝羼蹂钽犷犰箝镦翳骈戾溴屦泔痖弩镦疱蝽磲祜镳骘脲忮轭翳栳箬脲镦疱蝽磲躞轭ㄨ狍璀鲠祯鲠祯濠滹箦翩ㄧ弭栳箬脲蝓戾鲠祯濠戾è蝈篝鲠祯弩铘璀疱蝽蝈篝犰痂徕弭鲠祯弩瞟蝈篝脲蝈篝犰痂徕弭脲螬┅磲瓠扉篝蝓戾蝈篝脲蝈篝鲠祯弩ㄧ弭翎忪瀛鲠祯弩蝓戾┅┅ㄤ彐躅黠蜾箔漉犰扉篝黠蜾祜镳骘骝镯麸ō扉篝戾铉翳黠蜾博泔祆邈篝蜷铉麸扉篝ㄦ矧磲铋摸芒铘黠蜾铘ǐ暴黠蜾┅┅ㄤ彐躅泸遽翦漉犰翎忪痃蜥痂戾è漉犰翎忪磲脲栳箬翎忪呼弩у聃犰皓┅祜镳骘黠蜾轭痃蜥痂滹祜镳骘漉犰轭黠蜾箔漉犰扉篝黠蜾滹箦赳漉犰扉篝麸篝蜷铉漉犰┅滹ㄩ铛祆ㄧ弭栳箬漉犰漉犰翎忪濠箦翩ㄧ弭栳箬漉犰漉犰翎忪濠暴ㄩ钽ㄧ弭栳箬漉犰漉犰翎忪濠┅痱轭漉犰翎忪濠漉犰翎忪濠ㄤ彐躅珏舡泔ㄤ踽飙翎忪戾趑弪犰殓瞟ㄩ犰殓祜镳骘脲忮轭翳栳箬脲镦漉犰翎忪麒孱ㄥ戾趑弪铘篝蜷铉麸扉篝脲┅泔祆邈铘篝蜷铉麸扉篝脲┅祜镳骘脲忮轭翳栳箬脲镦漉犰翎忪麒孱ㄥ戾趑弪铘篝蜷铉麸扉篝脲┅泔祆邈铘篝蜷铉麸扉篝脲┅ㄤ彐躅翎忪宀狍扉篝翎忪濠戾è狍扉篝铋飑磲痂狍灬礅溽雯瘐箬ㄣ镱雯狍扉篝┅翎忪濠狍扉篝┅ㄤ彐躅翎忪瀛麸瓠鲠祯翎忪濠⒁弭躜铙翳麸孱趄骝镯栳箬翎忪瀹ㄣ狎ㄣ狎篚怏羼箫螋翎忪宀狍扉篝翎忪濠＇弘妁＇沅颟暴┅ㄤ彐躅珏舡泔翎忪痃蜥痂戾è泔翎忪磲脲栳箬翎忪濠盹篝泔镢沲蝈钽磲鸷徕ㄤ踽飙翎忪ㄣ蝈狒瀛漉犰翎忪痃蜥痂┅ㄤ踽ī漉犰黠蜾徕ㄦ轵篝戾趑弪ī骈蝮戾趑弪箦泔钿戾趑弪ī┅箦泔钿戾趑弪花痱轭漉犰翎忪濠祜镳麒殪ㄨ狍璀翎忪瀛泔躅漉犰翎忪濠癌徕箫蜮轭麒镬溟泗滹箦赳漉犰翎忪瀛麸瓠鲠祯漉犰翎忪濠滹箦赳骈蝮舡戾趑弪ㄦ轵篝篝蜷铉麸扉篝漉犰┅滹箦赳箦泔钿戾趑弪ㄦ轵篝灬篝篝蜷铉麸扉篝漉犰┅┅滹蝈漉沐漉犰翎忪漉犰翎忪骈蝮舡戾趑弪铋飑义盹鲥滹蝈漉沐漉犰翎忪漉犰翎忪箦泔钿戾趑弪舂义盹鲥滹箦翩ㄧ弭栳箬骈蝮舡戾趑弪泔翎忪濠箦泔钿戾趑弪┅泔翎忪濠ㄤ彐躅磲翥ㄤ殂舡翎忪沲篝镯翎忪蝓戾翎忪濠⑵轭铄磲翥桢骝镯蝓戾翎忪蝈玑蜾轭麸泔镢沲蝈钽翎忪弩戾è溟泗泔īㄣ躞麸憝泔īㄢ彐矧瀛箝ㄨ狍璀翎忪瀛泔躅蝓戾翎忪濠┅祜镳骘脲忮轭翳栳箬脲镦蝓戾翎忪躞轭ㄨ狍璀鲠祯鲠祯濠筢磲痧轭绾榄踞脲鲠祯搴滹箦赳溟泗泔ㄧ弭栳箬脲溟泗翎忪濠泔镢沲蝈钽搴轶滹箦赳沲篝镯泔ㄧ弭栳箬鲠祯沲篝镯翎忪濠┅泔镢沲蝈钽搴徕麒孱ㄡ钿沲篝镯泔溟泗泔怙翳铒铛祆滹ㄩ铛祆ㄧ弭栳箬溟泗泔蝓戾翎忪濠脲轭蝓戾轶铒镢沲痖邃鲠祯轭蝓戾轶铒镢沲痖邃ㄩ铛祆ㄦ轭沲篝镯泔ㄧ弭翎忪瀛鲠祯弩蝓戾翎忪濠┅箦翩ㄧ弭栳箬溟泗泔蝓戾翎忪濠沲篝镯泔┅┅蟓锯蝈趱蝾衄殒蝓戾翎忪栳汨犷珏ǒ忮骘蝈箝ㄨ狍璀翎忪瀛泔躅蝓戾翎忪濠┅ㄤ彐躅珏舡泔镢沲蝈钽瀛蝓戾痃蜥痂换溟泗轱钺蝙钞豇轶箴邈獒祆磲溴溟泗轱钺蝙骘牾篝麸箫祧换滹沲礤铘钞豇衄轸泔铘衢铙戾趑弪骝镯滹沲礤铘钞豇换骑麸箝眭灬翦翦篝汜箦筱孱狎轱铄邃邃疱蜴邈綮换骈趑轭溟泗轱钺蝙骘滹沲礤铘麸珏骈趑轭骝羼蹂铘篝狒轶糸泱镦漉犰换犷溴泸痿翳轶滹沲礤铘蝈玑蜾轭麸翳轶ю弪驽泗篝狒轶糸泱戾è溟泗ㄧ弭泔翎忪蝈徜痃蜥痂狍扉篝溟泗轱钺蝙钞豇簪┅ㄥ钽镤邃ㄧ弭泔翎忪痃蜥痂┅蝓戾翎忪磲脲栳箬翎忪濠┅翦蝠蜷痱轭⒛殂糸镱狎泔镢沲蝈钽弩孩痱轭溟泗翦蝠蜷痱轭⑴钽镤邃泔镢沲蝈钽弩孩痱轭孱泔溴洎磲瓠扉篝蝓戾翎忪盹篝骝羼蹂铘扉篝ㄦ蝈聃孱舡戾趑弪痃蜥痂┅祜镳麒殪磲翥溟泗孱泔溴蝓戾翎忪濠蝓戾翎忪濠ㄤ彐躅蝈漉沐漉犰翎忪ㄤ踽飙翎忪戾趑弪犰殓瞟戾è脲ī鲠祯ī┅ㄩ犰殓箦赳脲祜镳骘轭ㄧ弭犰痂徕弭┗议玷领殓铐孱镦戾趑弪泔祆邈ㄣ镱汜翦钺翦篝蜷铉篝蜷铉椹篝蜷铉戾趑弪┅┅箦赳脲祜镳骘轭ㄧ弭犰痂徕弭┗体骠领殓铐孱镦戾趑弪楠泔祆邈ㄣ镱汜翦钺翦篝蜷铉篝蜷铉戾趑弪篝蜷铉椹┅┅换义盹鲥雉桢蝮箝钽麇镱禊铄邃翳盹篝骝羼蹂铘镦翳屙祜镳骘轭脲滹蝈龛狍漉犰翎忪濠┅ㄤ彐躅骈钿孱泔溴蝓戾卤痃蜥痂戾è蝓戾翎忪ㄧ弭泔镢沲蝈钽瀛蝓戾痃蜥痂┅ㄤ殂ㄣ蝈狒瀛黠蜾翎忪蝈徜痃蜥痂狍扉篝溟泗轱钺蝙伯豇簪┅┅痱轭⒙蝓翦骑蜚轭萧桢体趑弪螽ㄤ雉轫弩ㄦ徙麸蜷犰捕┅ㄦ矧磲⒃弩糸铉宁ア瞟戾è蝓戾铘璀疱蝽蝓戾翎忪瞟筱矧癌祜镳骘黠蜾轭ㄤ邈镤瀛痃蜥痂痃蜥痂蝓戾滹ㄩ箴屐飙汨邈脲颦黠蜾溟泗ㄩ钽筱矧濠┅ㄦ矧磲⒂泔蝈宁ア筱矧濠ㄩ筱矧扉篝戾铉翳痃蜥痂┅蝈趱蝾骝镯骈钿孱泔溴蝓戾卤蝓戾┅┅换呐孟呐普蚊陨衔ㄤ彐躅清瞽腻泔溴颦疳蜥珧狃瑭戾è蝓戾ㄦ轭洵孱泔溴蝓戾簌礅镬拆珧狃疳蜥珧狃瑭┅痱轭葡瘴ㄦ躅泗轱灬礅溽黠蜾扉篝麸篝蜷铉ㄤ邈镤瀛黠蜾篝蜷铉麸扉篝黠蜾蝓戾┅┅┅ㄤ彐躅清瞽腻泔溴颦颅疳蜥珧狃瑭戾è蝓戾ㄦ轭洵孱泔溴蝓戾掳簌礅镬拆珧狃疳蜥珧狃瑭┅痱轭葡瘴ㄦ躅泗轱灬礅溽黠蜾扉篝麸篝蜷铉ㄤ邈镤瀛黠蜾篝蜷铉麸扉篝黠蜾蝓戾┅┅┅ㄤ彐躅清瞽腻泔溴颦颅疳蜥珧狃瑭戾è蝓戾ㄦ轭洵孱泔溴蝓戾卤簌礅镬拆珧狃疳蜥珧狃瑭┅痱轭葡瘴ㄦ躅泗轱灬礅溽黠蜾扉篝麸篝蜷铉ㄤ邈镤瀛黠蜾篝蜷铉麸扉篝黠蜾蝓戾┅┅┅ㄤ彐躅蔑溴买遽脲ㄤ镢蹴孱溴泔溴颟祜镳骘黠蜾轭簌礅镬拆珧狃滹沲礤铘泔祆邈篝蜷铉麸扉篝ㄦ躅汜祆溴泔溴黠蜾┅轭麸痃蜥痂骈钺祆蝈趱蝾祜镳骘黠蜾轭痃蜥痂滹瘐箬＼有撩ㄣ潋灬篝黠蜾┅泔祆邈扉篝麸篝蜷铉黠蜾轭麸翦骈钺祆蝈趱蝾扉篝麸篝蜷铉翦舂┅┅换藻篝泔溴ㄤ彐躅翦篝孱泔溴骈戾ī换翳妁麇蝈孱泸痿邃徙泔蜾轭麸骈蝮珏铄蜥糸镱镦泔礅轭狒轱铙换箫翳狒轸黠瞌翎脲眭汨糸礤麸溴泸痿漉蜷铉翳翦篝痂狍换窗鞍技捕换亠汜轭泸遽箦翳珏铄蜥糸镱铛礅弪麒殂鏖祆磲脲换翳泔礅轭狒轱铙忮趑弪黹邃躔弭翳轶糸礤秕箬秕熹铄邃麸换麽轸祜铉弪骘翳溴泔溴麸箫祧翳屙ㄥ钽镤瀛骈戾滹沲礤铘碑豇簪㈠钽镤邃哝殪灞豇簪铘璀疱蝽ㄧ弭犰痂徕弭舶鞍┅ㄥ钽镤瀛骈戾滹沲礤铘伯豇簪㈠钽镤邃哝殪宀豇簪铘璀疱蝽ㄧ弭犰痂徕弭车案┅ㄥ钽镤瀛骈戾滹沲礤铘钞豇簪㈠钽镤邃哝殪宄豇簪铘璀疱蝽ㄧ弭犰痂徕弭蛋癌ㄥ钽镤瀛骈戾滹沲礤铘串豇簪㈠钽镤邃哝殪宕豇簪铘璀疱蝽ㄧ弭犰痂徕弭钒癌ㄥ钽镤瀛骈戾滹沲礤铘诞豇簪㈠钽镤邃哝殪宓豇簪铘璀疱蝽ㄧ弭犰痂徕弭钡鞍┅ㄤ彐躅翦篝唢钸翦篝咪狒ī痱轭痱轭⒃弩糸铉痱轭戾è滹蝈徜狍扉篝溟泗轱钺蝙碑豇簪┅痱轭滹悌换珏滹沲礤铘戾è浔痃蜥痂搀礅镬蝈徜痃蜥痂狍扉篝㈠钽镤邃哝殪灞豇簪┅ㄤ痃蜥痂搀礅镬蝈徜痃蜥痂狍扉篝㈠钽镤邃哝殪宀豇簪┅ㄤ痃蜥痂搀礅镬蝈徜痃蜥痂狍扉篝㈠钽镤邃哝殪宄豇簪┅ㄤ痃蜥痂搀礅镬蝈徜痃蜥痂狍扉篝㈠钽镤邃哝殪宕豇簪┅ㄤ痃蜥痂搀礅镬蝈徜痃蜥痂狍扉篝㈠钽镤邃哝殪宓豇簪┅┅痱轭⑿蜷铘轭孱泸痿邃骈戾蠛痱轭浔痱轭洳痱轭涑痱轭浯痱轭浯痱轭⒂翎螋轭麸溴泸痿轭痂狍瀹换亠汜躅泔眄孱翳矬溴泔溴蝮汨邈翳屙换珏溴泔溴蝮戾è姹ㄇ孱腻泔溴颦浔┅ㄦㄇ孱腻泔溴颦洳┅ㄦㄇ孱腻泔溴颦颅涑┅ㄦㄇ孱腻泔溴颦颅浯┅ㄦㄇ孱腻泔溴颦颅涞┅痱轭⒛邈蝙痖铉轶滹铄、痱轭⒛镢蹴孱趔轭矧溴蚝痱轭蔑溴买遽脲浔姹┅翦蝠蜷痱轭蔑溴买遽脲洳娌┅翦蝠蜷痱轭蔑溴买遽脲涑娉┅翦蝠蜷痱轭蔑溴买遽脲浯娲┅翦蝠蜷痱轭蔑溴买遽脲涞娴┅换翦篝泔溴翦篝孱泔溴骈戾螬翦篝唢钸翦篝咪狒岍